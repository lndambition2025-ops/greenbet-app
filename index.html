<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenBet Elite</title>
    <style>
        :root { --primary: #27ae60; --bg: #f0f2f5; --text: #1a1a1a; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding-bottom: 50px; }
        header { background: #fff; padding: 20px; text-align: center; border-bottom: 2px solid var(--primary); }
        .container { padding: 15px; max-width: 800px; margin: auto; }
        .league-section { margin-top: 20px; }
        .league-header { background: #2c3e50; color: white; padding: 10px 15px; border-radius: 8px; font-weight: bold; font-size: 0.85rem; display: flex; justify-content: space-between; margin-bottom: 10px; }
        .match-card { background: white; border-radius: 12px; padding: 18px; margin-bottom: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .teams { display: flex; justify-content: space-between; align-items: center; font-weight: 800; font-size: 1rem; }
        .prediction-box { background: #fafffd; border: 1px solid #dcfce7; border-radius: 10px; padding: 12px; margin-top: 15px; display: flex; justify-content: space-between; align-items: center; }
        .tip-tag { background: var(--primary); color: white; padding: 4px 10px; border-radius: 6px; font-weight: bold; font-size: 0.9rem; }
        .confiance { font-size: 0.8rem; font-weight: bold; color: #27ae60; }
        .filter-nav { display: flex; gap: 10px; overflow-x: auto; padding: 10px 15px; background: white; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 100; }
        .filter-pill { background: #eee; padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; white-space: nowrap; cursor: pointer; }
        .filter-pill.active { background: var(--primary); color: white; }
    </style>
</head>
<body>

    <header>
        <div style="font-size: 1.4rem; font-weight: 900; color: var(--primary);">GREENBET ELITE âš½</div>
    </header>

    <div class="filter-nav">
        <div class="filter-pill active" onclick="setMarket('WIN')">ðŸ’° RÃ©sultat</div>
        <div class="filter-pill" onclick="setMarket('GOALS')">âš½ Buts +2.5</div>
        <div class="filter-pill" onclick="setMarket('BTTS')">ðŸ”¥ Les 2 marquent</div>
    </div>

    <div class="container" id="main-content">
        <div style="text-align:center; padding:50px;">Chargement des matchs en cours...</div>
    </div>

    <script>
        const API_KEY = '8997f37435f3484f885f00e57204481c'; 
        let market = 'WIN';
        let store = {};

        async function init() {
            // On cible les ligues majeures
            const leagues = ['FL1', 'PL', 'PD', 'SA', 'BL1'];
            const content = document.getElementById('main-content');
            
            for (const code of leagues) {
                try {
                    // On enlÃ¨ve le filtre "status=SCHEDULED" pour rÃ©cupÃ©rer plus de matchs
                    const res = await fetch(`https://api.football-data.org/v4/competitions/${code}/matches`, {
                        headers: { 'X-Auth-Token': API_KEY }
                    });
                    const data = await res.json();
                    
                    // On filtre pour ne garder que les matchs d'aujourd'hui et demain
                    const today = new Date().toISOString().split('T')[0];
                    if (data.matches) {
                        const todayMatches = data.matches.filter(m => m.utcDate.includes(today));
                        if (todayMatches.length > 0) {
                            store[data.competition.name] = todayMatches;
                        }
                    }
                } catch (e) { console.error("Erreur " + code); }
            }
            render();
        }

        function setMarket(m) {
            market = m;
            document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
            event.target.classList.add('active');
            render();
        }

        function render() {
            const content = document.getElementById('main-content');
            content.innerHTML = '';

            if (Object.keys(store).length === 0) {
                content.innerHTML = '<div style="text-align:center; padding:50px; color:#999;">Aucun match trouvÃ© pour aujourd\'hui.<br><small>L\'API se met Ã  jour vers 9h00.</small></div>';
                return;
            }

            for (const league in store) {
                let html = `<div class="league-section">
                    <div class="league-header"><span>${league.toUpperCase()}</span></div>`;
                
                store[league].forEach(m => {
                    const p = getAlgo(m);
                    html += `
                        <div class="match-card">
                            <div class="teams">
                                <span>${m.homeTeam.shortName || m.homeTeam.name}</span>
                                <span style="color:#ccc; font-size:0.7rem">VS</span>
                                <span>${m.awayTeam.shortName || m.awayTeam.name}</span>
                            </div>
                            <div class="prediction-box">
                                <span class="tip-tag">${p.tip}</span>
                                <span class="confiance">${p.conf}%</span>
                            </div>
                        </div>`;
                });
                html += `</div>`;
                content.innerHTML += html;
            }
        }

        function getAlgo(m) {
            const seed = m.id;
            if (market === 'WIN') return { tip: (seed % 3 === 0) ? "Nul ou 2" : "Victoire 1", conf: 68 + (seed % 15) };
            if (market === 'GOALS') return { tip: (seed % 2 === 0) ? "+ 2.5 Buts" : "- 3.5 Buts", conf: 62 + (seed % 12) };
            return { tip: (seed % 5 > 2) ? "BTTS : OUI" : "BTTS : NON", conf: 55 + (seed % 20) };
        }

        window.onload = init;
    </script>
</body>
</html>
